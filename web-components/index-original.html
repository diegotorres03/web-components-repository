<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bundle Testing!</title>
</head>

<body>
  <style>
    .hidden {
      display: none;
    }

    .grid {
      display: grid;
      grid-template-columns: 50% 50%;
      grid-template-rows: 50% 50%;
    }
  </style>

  <nav>
    <a href="#page1">page1</a>
    <a href="#page2">page2</a>
    <a href="#page3">page3</a>
    <a href="#page4">page4</a>
  </nav>

  <script id="guard-fn">
    const guards = Object.freeze({
      guest: (ev) => { console.log(ev); return true },
      admin: (ev) => { console.log(ev); return false },
    })
  </script>

  <script>
    guards.guest('test')
  </script>

  <app-modal trigger="[hash='page2']" trigger-event="activated">
    <h1 slot="main">nagigation event detected</h1>
  </app-modal>


  <!-- <app-layout> -->

  <app-router slot="main">

    <app-route hash="login">
      <div>
        <label for="">username:</label><input type="text"><br>
        <label for="">password:</label><input type="password"><br>
      </div>
    </app-route>

    <app-route hash="page1" guard="guest">
      <h1>Page 1</h1>

      <button id="modal-btn">Cualquier texto ah√≠ cagado</button>
      <flip-card></flip-card>
      <app-modal trigger="#modal-btn">



        <app-accordion slot="main">
          <section>
            <h1>test</h1>
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Non, fugiat voluptates, consectetur adipisci
              natus fuga quas aliquam dignissimos itaque deleniti hic? Ea praesentium numquam officia quaerat nisi hic
              explicabo. Odio.</p>
          </section>
          <section>
            <h1>test</h1>
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Non, fugiat voluptates, consectetur adipisci
              natus fuga quas aliquam dignissimos itaque deleniti hic? Ea praesentium numquam officia quaerat nisi hic
              explicabo. Odio.</p>
          </section>
          <section>
            <h1>test</h1>
            <p>Lorem ipsum dolor, sit amet consectetur adipisicing elit. Non, fugiat voluptates, consectetur adipisci
              natus fuga quas aliquam dignissimos itaque deleniti hic? Ea praesentium numquam officia quaerat nisi hic
              explicabo. Odio.</p>
          </section>
        </app-accordion>
      </app-modal>

    </app-route>
    <app-route hash="page2" guard="admin">
      <h1>Page 2</h1>
    </app-route>
    <app-route hash="page3">
      <h1>Page 3</h1>
    </app-route>
    <app-route hash="page4" trigger="app-modal">
      <h1>Page 4</h1>



    </app-route>
  </app-router>
  <!-- </app-layout> -->

  <select id="select-number">
    <option>1</option>
    <option>2</option>
    <option>3</option>
    <option>4</option>
  </select>



  <div class="grid">
    <button id="btn1">btn1</button>
    <button id="btn2">btn2</button>

    <button id="btn3">btn3</button>
    <button id="btn4">btn4</button>
    <button id="btn5">btn5</button>
    <button id="btn6">btn6</button>

  </div>



  <event-stream>

    <event-group id="group-1">
      <event-source trigger="#btn1" filter="#filter-fn" transform="map-fn" />
      <event-source id="source1-2" trigger="#btn2" />
    </event-group>

    <event-group id="group-2">
      <event-source trigger="#btn3" />
      <event-source trigger="#btn4" />
    </event-group>

    <event-group id="group-4" transform="#random-data">
      <event-source trigger="#btn5" />
      <event-source trigger="#btn6" />
    </event-group>

    <event-group id="group-3">
      <event-source trigger="#select-number" trigger-event="change" transform="#random-data" />
    </event-group>

  </event-stream>

  <app-modal trigger="[trigger='#btn4']" trigger-event="data"></app-modal>
  <!-- <app-modal trigger="#group-2" trigger-event="data"></app-modal> -->

  <!-- <script>
    const source = document.querySelector('#source1-2')
    console.log(source)
    source.addEventListener('data', ev => console.log('si llego', event))
  </script> -->

  <js-fn id="random-data">
    function(data) {
      console.log('random data generation')
      const res = {
        value: new Date().getSeconds(),
        label: 'test'
      }
      console.log('res', res)
      return res
    }
  </js-fn>

  <js-fn id="direct-filter-fn" trigger="#btn3">
    function(event) {
      console.log('direct-filter-fn')
      return new Date().getMinutes() % 10 !== 0
    }
  </js-fn>


  <js-fn id="direct-map-fn" trigger="#direct-filter-fn">
    function (event) {
    console.log('direct-map-fn')
    return {
    success: true,
    name: event.detail.name
    }
    }
  </js-fn>


  <!-- <js-fn id="log" trigger="event-source" type="filter"> -->
  <js-fn id="log" trigger="#group-1" type="filter">
    function (event, params) {
    // console.log('(>*.*)>')
    // console.log(event)
    return { success: true }
    }
  </js-fn>

  <js-fn id="map-fn">
    function (event) {
    console.log('map-fn')
    return {
    success: true,
    name: event.detail.name
    }
    }
  </js-fn>



  <js-fn id="filter-fn" trigger="#log">
    function(event) {
    console.log('filter-fn-s')
    return new Date().getMinutes() % 10 !== 0
    }
  </js-fn>

  <data-set visible id="event-log" trigger="#group-4" trigger-event="data"></data-set>
  <data-set trigger="app-router" trigger-event="navigated"></data-set>


</body>

</html>
  <!-- 
  <state-machine>
    <machine-context>

    </machine-context>
    <machine-states>
      <machine-state name="initial" guards=""></machine-state>
    </machine-states>
  </state-machine>

  <event-bus>
    <event-router trigger-event="moda-ended">
      <event-listener trigger="app-modal" trigger-event="accepted"></event-listener>
      <event-listener trigger="app-modal" trigger-event="declined"></event-listener>
    </event-router>
  </event-bus> -->

  <!-- <script>
    document.querySelector('#flip-btn')
      .addEventListener('click', ev => console.log(ev))
  </script> -->